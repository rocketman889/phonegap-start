<!DOCTYPE html>
<html>
  <head>
    <title>Acceleration Example</title>
		<link rel="stylesheet"  href="css/jquery.mobile-1.3.1.min.css">
		<script src="js/jquery.js"></script>
		<script src="js/jquery.mobile-1.3.1.min.js"></script>
  		 <script type="text/javascript" src="phonegap.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" charset="utf-8">

    // The watch id references the current `watchAcceleration`
    var watchID = null;

    // Wait for Cordova to load
    document.addEventListener("deviceready", onDeviceReady, false);

   
    // Start watching the acceleration
    function startWatch() {
        // Update acceleration every 3 seconds
        var options = { frequency: 3000 };
        watchID = navigator.accelerometer.watchAcceleration(onSuccess, onError, options);
    }

    // Stop watching the acceleration
    function stopWatch() {
        if (watchID) {
            navigator.accelerometer.clearWatch(watchID);
            watchID = null;
        }
    }

    // onSuccess: Get a snapshot of the current acceleration
    //
    function onSuccess(acceleration) {
        var element = document.getElementById('accelerometer');
        element.innerHTML = 'Acceleration X: ' + acceleration.x + '<br />' +
                            'Acceleration Y: ' + acceleration.y + '<br />' +
                            'Acceleration Z: ' + acceleration.z + '<br />' + 
                            'Timestamp: '      + acceleration.timestamp + '<br />';
    }

    // onError: Failed to get the acceleration
    function onError() {
        alert('onError!');
    }
    
    function add(){
    	//alert("Hello!");
		var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);
		db.transaction(addRowDB, errorCB, addRowDBGood);
    }
    
    function addRowDB(tx) {
    	tx.executeSql('INSERT INTO DEMO (data) VALUES ( "new row")');
    }
   
    function addRowDBGood(tx, results) {
    	var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);
        db.transaction(queryDB2, errorCB);
      }
 
 // Query the database
    function queryDB2(tx) {
        tx.executeSql('SELECT MAX(id) AS id, data FROM DEMO', [], querySuccess2, errorCB2);
    }
    
    // Query the success callback
    function querySuccess2(tx, results) {
         var len = results.rows.length;
        for (var i=0; i<len; i++){
             addHTMLRow(results.rows.item(i).id, results.rows.item(i).data);
        }
    }

    // Transaction error callback
    function errorCB2(err) {
        console.log("Error processing SQL baby: "+err.code);
    }

    // Transaction error callback
    function errorCB(err) {
        console.log("Error processing SQL: "+err.code);
    }

    // Cordova is ready
    function onDeviceReady() {
        var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);
        db.transaction(populateDB, errorCB, successCB);
    }
    
     // Populate the database 
    function populateDB(tx) {
      //  tx.executeSql('DROP TABLE IF EXISTS DEMO');
        tx.executeSql('CREATE TABLE IF NOT EXISTS DEMO (id INTEGER PRIMARY KEY AUTOINCREMENT, data)');
       // tx.executeSql('INSERT INTO DEMO ( data) VALUES  ("First row")');
      // tx.executeSql('INSERT INTO DEMO ( data) VALUES ( "Second row")');
    }
    
     // Transaction success callback
    function successCB() {
        var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);
        db.transaction(queryDB, errorCB);
    }
    
     // Query the database
    function queryDB(tx) {
        tx.executeSql('SELECT * FROM DEMO', [], querySuccess, errorCB);
    }

    // Query the success callback
    function querySuccess(tx, results) {
         var len = results.rows.length;
         document.getElementById("db_list1").innerHTML="DEMO table: " + len + " rows found.";
        for (var i=0; i<len; i++){
             addHTMLRow(results.rows.item(i).id, results.rows.item(i).data);
        }
    }

	function addHTMLRow(id, data)
	{
		var x=document.getElementById('myTable').insertRow(-1);
		var y=x.insertCell(0);
		var z=x.insertCell(1);
		y.innerHTML=id;
		z.innerHTML=data;
	}

    </script>
  </head>
  <body>
  	<div data-role="page" id="home">
  		<div data-role="header">
  			<h1>PG App Test</h1>
  		</div>
  		<div data-role="content">
  			<a href="#accel" data-role="button">Accelerometer</a>
  			<a href="#storage" data-role="button">Local Storage</a>
  		</div>
  		<div data-role="footer" data-position="fixed">
  			<h1><a href="http://www.somethingsdeveloping.com" target="_blank">Somethuyging's Developing</a></h1>
  		</div>
  	</div>
  	
  	<div data-role="page" id="accel">
  		<div data-role="header">
  			<a href="#home">Home</a>
  			<h1>Accelerometer</h1>
  		</div>
  		<div data-role="content">
  			<h3>Here is the accelerometer data of the device!</h3>
  			<div id="accelerometer">Waiting for accelerometer...</div>
    		<button onclick="startWatch();">START Watching</button>
    		<button onclick="stopWatch();">Stop Watching</button>
  		</div>
  		<div data-role="footer" data-position="fixed">
  			<h1><a href="http://www.somethingsdeveloping.com" target="_blank">Something's Developing</a></h1>
  		</div>
  	</div>
  	
  	<div data-role="page" id="storage">
  		<div data-role="header">
  		<a href="#home">Home</a>
  			<h1>Storage</h1>
  		</div>
  		<div id="everything" data-role="content">
  			<h1>Storage Example</h1>
  			<div id="db_list1"></div>
			<table id="myTable" border="1">
				<tr>
					<th>ID</th>
					<th>Data</th>
				</tr>
			</table>
			
			<br>
  			<a href="" onclick="add()" data-role="button">Add to DB</a>
  		</div>
  		<div data-role="footer" data-position="fixed">
  			<h1><a href="http://www.somethingsdeveloping.com" target="_blank">Something's Developing</a></h1>
  		</div>
  	</div>
    
  </body>
</html>
